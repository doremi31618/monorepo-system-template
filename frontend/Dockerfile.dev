FROM node:20-alpine

WORKDIR /monorepo

# 1. Copy root package files (skip lockfile to force workspace resolution)
COPY package.json ./

# 2. Copy shared libraries
COPY share ./share

# 3. Copy service package files
COPY frontend/package.json ./frontend/

# 4. Install dependencies from root
RUN npm install

# 5. Copy service source code
COPY frontend ./frontend

# 6. Set working directory to frontend service
WORKDIR /monorepo/frontend

CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0", "--strictPort"]